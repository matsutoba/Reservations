create table dbo.User (
    Id int primary key generated by default as IDENTITY,
    Name varchar(64),
    IsDeleted int default 0,
    CreatedAt date,
    CreateUser varchar(64),
    ModifiedAt date NULL,
    ModifyUser varchar(64) NULL
);

create table dbo.Customer (
    Id int primary key generated by default as IDENTITY,
    Name varchar(64),
    IsDeleted int default 0,
    CreatedAt date,
    CreateUser varchar(64),
    ModifiedAt date NULL,
    ModifyUser varchar(64) NULL
);

create table dbo.Facility (
    Id int primary key generated by default as IDENTITY,
    Name varchar(255),
    IsDeleted int default 0,
    CreatedAt date,
    CreateUser varchar(64),
    ModifiedAt date NULL,
    ModifyUser varchar(64) NULL    
)

// どの期間で有効か
create table dbo.Frame (
    Id int primary key generated by default as IDENTITY,
    FacilityId int, 
    StartDate date,
    EndDate date,
    IsDeleted int default 0,
    CreatedAt date,
    CreateUser varchar(64),
    ModifiedAt date NULL,
    ModifyUser varchar(64) NULL,
    FOREIGN KEY ( FacilityId ) REFERENCES dbo.Facility ( Id )
)

create table dbo.TimeFrame (
    Id int primary key generated by default as IDENTITY,
    FrameId int,
    DayOfWeek int,
    StartTime char(5),
    EndTime char(5),
    IsDeleted int default 0,
    CreatedAt date,
    CreateUser varchar(64),
    ModifiedAt date NULL,
    ModifyUser varchar(64) NULL,
    FOREIGN KEY ( FrameId ) REFERENCES dbo.Frame ( Id )
);

create table dbo.Reservation (
    Id int primary key generated by default as IDENTITY,
    CustomerId int,
    ReservationDate char(8),
    ReservationTimeFrameId int,
    IsDeleted int default 0,
    CreatedAt date,
    CreateUser varchar(64),
    ModifiedAt date NULL,
    ModifyUser varchar(64) NULL,
    FOREIGN KEY ( CustomerId ) REFERENCES dbo.Customer ( Id ),
    FOREIGN KEY ( ReservationTimeFrameId ) REFERENCES dbo.TimeFrame ( Id )
);


insert into dbo.User values (
    1, 'たろう', 0, '2020-12-12', 'U001'
)

insert into dbo.Customer values (
    1, 'お客１', 0, '2020-12-12', 'U001'
)
insert into dbo.Customer values (
    2, 'お客２', 0, '2020-12-12', 'U001'
)

insert into dbo.Facility values (
    1, 'ＡＢＣレストラン', 0, '2020-12-12', 'U001'
)
insert into dbo.Frame values (
    1, 1, '2020-01-01', '2099-12-31', 0, '2020-12-12', 'U001'
)

insert into dbo.TimeFrame values (
    1, 1, 0, '10:00', '11:00', 0, '2020-12-12', 'U001'
)
insert into dbo.TimeFrame values (
    2, 1, 0, '11:00', '12:00', 0, '2020-12-12', 'U001'
)

insert into dbo.Reservation values (
    1, 1, '2020-12-12', 1, 0, '2020-12-12', 'U001'
)



select * from dbo.User;
select * from dbo.Customer;
select * from dbo.Facility;
select * from dbo.Frame;
select * from dbo.TimeFrame;
select * from dbo.Reservation;


select * from dbo.Customer c
inner join dbo.Reservation r on c.Id = r.CustomerId;

truncate table dbo.Customer;
